<!DOCTYPE html>
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <style>
      body {
        font-family: Candara, Calibri, Segoe, "Segoe UI", Optima, Arial, sans-serif;
        color: #558055;
      }
      sup {
        font-size: 0.6em;
      }
      pre {
        border: 1px solid #999;
        background: #eee;
        float: left;
        padding: 0.5em;
        margin: 0 0 1em 2em;
      }
      p {
        clear: left;
      }
    </style>
  </head>
  <body>
    <h3>The world's most verbose<sup>1</sup> hello world web page</h3>
    <p>This is an example of using web-commonjs in a single web page.<br>
    Your projects may start out this way when you're prototyping something,<br>
    deploying a stand-alone static page, or sending someone a html carve-up.</p>
    <p>This page is one of three ways to use web-commonjs:</p>
    <ul>
      <li>embedded in a web page like this example</li>
      <li>loaded from source files using the dynamic loader</li>
      <li>packaged, minified code generated by one of the packaging scripts</li>
    </ul>
    <p>There are three small CommonJS modules pasted into this page.<br>
    Each source file is wrapped in the following boilerplate:</p>
    <pre>cjs_provide("MODULE_PATH",function(exports,require){
  // contents of CommonJS module go here...
});</pre>

  <p>The website module requires std/greetings to get its default_greeting symbol.<br>
  The greetings module uses a relative require to load the messages module.<br>
  The messages module contains the hello world message to display.</p>

  <p>Our website module also imports jQuery, to demonstrate 'shimming' an existing<br>
  global object into the module system as if it were a CommonJS module.</p>

  <p><sup>1</sup> statement may not actually be true.</p>

    <div id="hello"></div>
    <script>

/* github.com/raffecat/web-commonjs v1 */
var __cjs;__cjs=__cjs||{};function cjs_provide(n,f){__cjs[n]={f:f}}
function require(n){var G=__cjs,p,q=[],i,s,m,r,o=G.$;s=n.charAt(0);
if(s==='.'||s==='..')n=o+'/../'+n;p=n.split('/');for(i=0;i<p.length
;i++)s=p[i],s!=="."&&(s===".."?q.pop():q.push(s));n=q.join("/");m=G
[n];if(!m)throw "Module not found: "+n;if(m.e)return m.e;try{G.$=n;
m.f(m.e={},require)}finally{G.$=o}return m.e;}
function cjs_shim(n,e){__cjs[n]={e:e}}

/* website.js ------------------------------------------------------------ */
cjs_provide("website",function(exports,require){

  var $ = require('jQuery');
  var greets = require('std/greetings');

  $('#hello').css({
    backgroundColor:'#93c3cd',padding:'1em',float:'left',color:'white'
  }).text(greets.default_greeting);

});

/* std/greetings.js ------------------------------------------------------ */
cjs_provide("std/greetings",function(exports,require){

  var msgs = require('./messages');

  exports.default_greeting = msgs.hello_message;

});

/* std/messages.js ------------------------------------------------------- */
cjs_provide("std/messages",function(exports,require){

  exports.hello_message = "Hello world";

});

// provide standard jQuery as a CommonJS module.
cjs_shim('jQuery', $);

// require the website module on this page.
require('website');

    </script>
  </body>
</html>
